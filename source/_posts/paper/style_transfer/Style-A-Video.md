---
title:  "Style-A-Video: Agile Diffusion for Arbitrary Text-Based Video Style Transferè®ºæ–‡ç†è§£"

date:  2024-11-7 11:28:00

tags:  [è®ºæ–‡,é£æ ¼è¿ç§»]

categories:  [é£æ ¼è¿ç§»]

comment:  false

toc:  true

---

#

<!--more-->



ï¼ˆåŸºäºcontrolnetçš„ç‰¹å¾èåˆæ–¹æ³•ï¼Ÿï¼‰

é€šè¿‡åŸºäºæµçš„æ­£åˆ™åŒ–ç½‘ç»œå‡å°‘é—ªçƒã€‚



- ä¼˜åŒ–ç›®æ ‡ï¼š

$$L=\mathbb{E}_{\mathcal{E}(\boldsymbol{x}),\boldsymbol{c}_I,\boldsymbol{c}_T,\boldsymbol{c}_M,\boldsymbol{\epsilon}\sim\mathcal{N}(0,1),t}\left[\|\boldsymbol{\epsilon}-\boldsymbol{\epsilon}_\theta(\boldsymbol{z}_t;\boldsymbol{c}_I,\boldsymbol{c}_T,\boldsymbol{c}_M,t)\|_2^2\right]$$

åƒåœ¾

# 0. Abstract

- å¤§è§„æ¨¡çš„æ–‡ç”Ÿè§†é¢‘æ‰©æ•£æ¨¡å‹æ˜¾ç¤ºå‡ºå‡ºè‰²èƒ½åŠ›ã€‚ç„¶è€Œï¼š
  -  æ–‡æœ¬è§†é¢‘æ•°æ®é›†å’Œè®¡ç®—èµ„æºçš„æœ‰é™æ€§é˜»ç¢äº†å®ƒä»¬åœ¨è§†é¢‘æ ·å¼åŒ–ä¸­çš„ç›´æ¥åº”ç”¨ã€‚ 
  -  ç”±äºå™ªå£°æ·»åŠ è¿‡ç¨‹çš„éšæœºæ€§å’Œç ´åæ€§ï¼Œæ»¡è¶³é£æ ¼è¿ç§»ä»»åŠ¡çš„å†…å®¹ä¿å­˜æ ‡å‡†æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ã€‚ 

- æœ¬æ–‡ä»‹ç»äº†ä¸€ç§ç®€æ´çš„ï¼ˆarxivä¸­å†™çš„æ˜¯zero shortï¼‰è§†é¢‘é£æ ¼åŒ–æ–¹æ³•ï¼Œ  åˆ©ç”¨ç”Ÿæˆå¼**é¢„è®­ç»ƒtransformer**ï¼ˆæ–‡ç« é‡Œæ²¡çœ‹åˆ°transformerå•Šï¼Ÿï¼‰å’Œå›¾åƒldmè¿›è¡Œæ–‡æœ¬æ§åˆ¶è§†é¢‘é£æ ¼åŒ–ã€‚ 
  -  æˆ‘ä»¬æ”¹å–„äº†å»å™ªè¿‡ç¨‹ä¸­çš„å¼•å¯¼æ¡ä»¶ï¼Œä»¥ä¿æŒè‰ºæœ¯è¡¨è¾¾å’Œç»“æ„ä¿å­˜ä¹‹é—´çš„å¹³è¡¡ã€‚ 
  -  æ­¤å¤–ï¼Œé€šè¿‡é›†æˆé‡‡æ ·ä¼˜åŒ–æ¨¡å—å’Œæ—¶é—´ä¸€è‡´æ€§æ¨¡å—ï¼Œæˆ‘ä»¬è§£å†³å¸§é—´é—ªçƒå’Œé˜²æ­¢é¢å¤–çš„ä¼ªå½±ã€‚ 



# 1. Introduction

- æ–‡ç”Ÿå›¾å¾—åˆ°å·¨å¤§å‘å±•ï¼Œ è¿™ä¸€å‘å±•ä¸ºä½¿ç”¨ç°æœ‰çš„generative worksç¼–è¾‘ç°å®ä¸–ç•Œçš„è§†é¢‘æä¾›äº†è®¸å¤šå¯èƒ½æ€§ã€‚  ç„¶è€Œï¼Œç”¨äºç¼–è¾‘çœŸå®ä¸–ç•Œè§†é¢‘çš„æ‰©æ•£æ¨¡å‹ä»ç„¶å…·æœ‰æŒ‘æˆ˜æ€§å’Œè¦æ±‚ã€‚ 

-  ç”±äºéš¾ä»¥æ”¶é›†åˆ°ä¸æ–‡æœ¬å’Œè§†é¢‘ç›¸åŒ¹é…çš„å¤§è§„æ¨¡æ•°æ®ï¼Œä¸å›¾åƒé¢†åŸŸç›¸æ¯”ï¼Œè§†é¢‘é¢†åŸŸçš„è¿›æ­¥æœ‰é™ã€‚ä»å¤´å¼€å§‹è®­ç»ƒæ–‡æœ¬å¼•å¯¼è§†é¢‘ç”ŸæˆèŒƒå¼è€—æ—¶  ï¼Œå¹¶ä¸”éš¾ä»¥è·å¾—å’Œæ¨å¹¿ã€‚ 

- å› æ­¤ï¼Œ**åˆ©ç”¨ç°æœ‰çš„æ–‡æœ¬-å›¾åƒæ¨¡å‹ç”Ÿæˆè§†é¢‘æ›´ä¸ºå®ç”¨**ã€‚åŒæ—¶ï¼ŒåŸºäºæ–‡æœ¬-å›¾åƒæ¨¡å‹çš„è§†é¢‘æ–¹é¢çš„ç ”ç©¶ä¹Ÿå–å¾—äº†å¯å–œçš„æˆæœã€‚ 

-  æˆ‘ä»¬å¸Œæœ›å®ç°å¯¹ä»»æ„è§†é¢‘çš„å¿«é€Ÿæ¨ç†ï¼Œä»¥é¿å…æ˜‚è´µçš„è®¡ç®—æ¶ˆè€—ã€‚ 

-  ç”±äºæ‰©æ•£æ¨¡å‹ä¸­å™ªå£°æ·»åŠ è¿‡ç¨‹å¯¹å†…å®¹çš„ç ´åæ€§å’Œå»å™ªè¿‡ç¨‹çš„éšæœºæ€§ï¼Œè¾“å…¥çš„è§†é¢‘å†…å®¹å¾€å¾€éš¾ä»¥ä¿ç•™ã€‚æ­¤å¤–ï¼Œæ–‡æœ¬-è§†é¢‘æ¨¡å‹ä¸­çš„**æ–‡æœ¬æç¤ºåªå‘Šè¯‰æ¨¡å‹ç”¨æˆ·æƒ³è¦æ”¹å˜ä»€ä¹ˆï¼Œè€Œæ²¡æœ‰ä¼ è¾¾ç”¨æˆ·æƒ³è¦ä¿ç•™ä»€ä¹ˆã€‚**å› æ­¤ï¼Œæ–‡æœ¬å¼•å¯¼çš„è§†é¢‘ä¼ è¾“å·¥ä½œå¯¼è‡´**è§†é¢‘ä¸­çš„å†…å®¹ä¿®æ”¹**ï¼Œè¿™å¾ˆéš¾æ»¡è¶³é£æ ¼åŒ–ä»»åŠ¡çš„åŸºæœ¬è¦æ±‚ã€‚ 

-  ä¸ºäº†å®ç°**æ–‡æœ¬æç¤ºçš„é£æ ¼è¡¨ç¤º**ã€**è¾“å…¥è§†é¢‘å†…å®¹ä¿¡æ¯çš„ä¿å­˜**ã€**å¸§é—´ä¸€è‡´æ€§**å’Œ**æ¨ç†è¿‡ç¨‹çš„å¿«é€Ÿä¼˜åŒ–**ï¼Œæˆ‘ä»¬é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªåŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼š
  -  æå‡ºäº†ä¸€ç§æ–°çš„æ§åˆ¶æ¡ä»¶ç»„åˆï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€è§†é¢‘å¸§å’Œæ³¨æ„å›¾ï¼›å…·ä½“æ¥è¯´ï¼Œæ–‡æœ¬ç”¨äºé£æ ¼æŒ‡å¯¼ï¼Œè§†é¢‘æ¡†æ¶ç”¨äºå†…å®¹æŒ‡å¯¼ï¼Œæ³¨æ„å›¾ç”¨äºç»†èŠ‚æŒ‡å¯¼ã€‚ 
  -  é‡‡ç”¨è‡ªå®šä¹‰åˆ¶å¯¼ä¸æ— åˆ†ç±»å™¨åˆ¶å¯¼ç›¸ç»“åˆçš„æ–¹æ³•å¯¹å™ªå£°é¢„æµ‹è¿‡ç¨‹è¿›è¡Œè°ƒæ•´ã€‚  åœ¨å®ç°æ–‡æœ¬å¼•å¯¼é£æ ¼åŒ–çš„åŒæ—¶ï¼Œå¾ˆå¥½åœ°ç»´æŠ¤äº†è¾“å…¥è§†é¢‘çš„å…¨å±€å†…å®¹ã€‚ 
  -  æˆ‘ä»¬åœ¨æ¨ç†è¿‡ç¨‹ä¸­å®ç°äº†å¿«é€Ÿæ”¶æ•›ï¼Œæ— éœ€å¾®è°ƒæˆ–é¢å¤–çš„è®­ç»ƒï¼Œä»è€Œå®ç°äº†æ–‡æœ¬è§†é¢‘è¾“å…¥çš„ä»»æ„é£æ ¼åŒ–ä»»åŠ¡ã€‚ 
  -  æœ€åï¼Œå¼•å…¥æ—¶é—´ä¸€è‡´æ€§æ¥æ¶ˆé™¤é—ªçƒï¼Œå¢å¼ºæ—¶é—´ç›¸å¹²æ€§ã€‚ 

- è´¡çŒ®ï¼š
  -  æå‡ºäº†Style-A-Videoï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºæ‰©æ•£æ¨¡å‹çš„ä»»æ„æ–‡æœ¬é©±åŠ¨è§†é¢‘æ ·å¼çš„æ–°æ¡†æ¶ã€‚è¿™é¡¹å·¥ä½œå®Œå…¨åœ¨æ¨ç†æœŸé—´å†…å®Œæˆï¼Œæ— éœ€é¢å¤–çš„æ¯ä¸ªè§†é¢‘è®­ç»ƒæˆ–å¾®è°ƒï¼ˆæ˜¯è¯´ä¸éœ€è¦é’ˆå¯¹æ¯ä¸ªè§†é¢‘è®­ç»ƒçš„ä»»æ„é£æ ¼è¿ç§»è¿˜æ˜¯è¯´æœ¬æ–‡æ˜¯zero-shotçš„æ¡†æ¶ï¼Ÿï¼‰ã€‚ 
  -  æå‡ºæ–°é¢–çš„å™ªå£°é¢„æµ‹æŒ‡å¯¼å…¬å¼ï¼Œå®ç°é£æ ¼ã€å†…å®¹ã€ç»“æ„çš„åŒæ­¥æ§åˆ¶ã€‚å¹¶åœ¨æ¨ç†è¿‡ç¨‹ä¸­å®ç°äº†æ—¶é—´å’Œå†…å®¹ä¸€è‡´æ€§çš„æ§åˆ¶ã€‚ 



# 2. Relate work

## 2.1 å›¾åƒ/è§†é¢‘é£æ ¼è¿ç§»

- NST
- äºŒé˜¶ç»Ÿè®¡é£æ ¼
- AdaIN
- StyTr2
- CAST

ã€‚ã€‚ã€‚

- æœ¬æ–‡æ„åœ¨æå‡ºä¸€ç§é«˜æ•ˆçš„é›¶é•œå¤´è§†é¢‘é£æ ¼è½¬ç§»æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨æ—¶é—´ä¸€è‡´æ€§å’Œé£æ ¼è¡¨è¾¾æ–¹é¢éƒ½å¾ˆæˆåŠŸã€‚ 

- è§†é¢‘é£æ ¼è¿ç§»ï¼š é‡‡ç”¨å‚è€ƒé£æ ¼å›¾åƒï¼Œå¹¶ç»Ÿè®¡åœ°å°†å…¶é£æ ¼åº”ç”¨äºè¾“å…¥è§†é¢‘ 

  >Coherent online video style transfer.ï¼ˆ2017ï¼‰
  >
  >Arbitrary video style transfer via multi-channel correlation.ï¼ˆ2021ï¼‰
  >
  >Fast video multistyle transfer.ï¼ˆ2020ï¼‰
  >
  >Exploring the Temporal Consistency of Arbitrary Style Transfer: A Channelwise Perspective.ï¼ˆ2023ï¼‰
  >
  >Artistic style transfer for videos.ï¼ˆ2016ï¼‰

  

-  ç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨å—æå–çš„ç»“æ„æ•°æ®çº¦æŸçš„åŒæ—¶ï¼Œä»è¾“å…¥æ–‡æœ¬æç¤ºç¬¦æˆ–å›¾åƒä¸­æ··åˆåº”ç”¨æ ·å¼å’Œå†…å®¹ã€‚é€šè¿‡ä»æ•°æ®ä¸­**å­¦ä¹ ç”Ÿæˆæ¨¡å‹**ï¼Œæˆ‘ä»¬çš„æ–¹æ³•äº§ç”Ÿè¯­ä¹‰ä¸€è‡´çš„è¾“å‡ºï¼Œè€Œä¸æ˜¯åŒ¹é…ç‰¹å¾ç»Ÿè®¡ã€‚ 



## 2.2 æ–‡å­—åˆ°å›¾åƒçš„ç”Ÿæˆ/ç¼–è¾‘

- gan
- diffusion
- diffusioné£æ ¼è¿ç§»ï¼šMGADï¼ŒDiffStylerï¼ŒInST



## 2.3 æ–‡å­—åˆ°è§†é¢‘çš„ç”Ÿæˆ/ç¼–è¾‘

-  æ²¡æœ‰è¶³å¤Ÿçš„é«˜è´¨é‡æ–‡æœ¬å’Œè§†é¢‘å¯¹ã€‚ 

-  CogVideo[20]å°†CogView-2[8]æ‰©å±•åˆ°æ–‡æœ¬åˆ°è§†é¢‘çš„ç”Ÿæˆï¼Œåˆ©ç”¨é¢„è®­ç»ƒçš„æ–‡æœ¬åˆ°å›¾åƒæ¨¡å‹å’Œæ—¶é—´æ³¨æ„åŠ›æ¨¡å—æ¥æé«˜è§†é¢‘ç”Ÿæˆçš„è´¨é‡ã€‚ 

- video diffusion models
- Imagen Video
- make a video
- Text2LIVE
- SinFusion
- Tune a video
- Gen-1



# 3. Method

- æœ¬æ–‡ç›®çš„ï¼š æ ¹æ®æ–‡æœ¬æ¡ä»¶Tå¯¹è¾“å…¥è§†é¢‘è¿›è¡Œé£æ ¼åŒ–ç¼–è¾‘ï¼ŒåŒæ—¶ä¿ç•™è¾“å…¥è§†é¢‘çš„å†…å®¹å’Œç»“æ„ã€‚ å†…å®¹å…·ä½“å®šä¹‰ä¸ºè¾“å…¥è§†é¢‘çš„å¤–è§‚å’Œè¯­ä¹‰ä¿¡æ¯ã€‚ç»“æ„æ˜¯æŒ‡è¾“å…¥è§†é¢‘çš„å½¢çŠ¶å’Œå‡ ä½•ç‰¹å¾ã€‚ 
  -  ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†è¾“å…¥å¸§ä¿¡æ¯ï¼ˆè¡¨ç¤ºä¸ºğ¼ï¼‰å’Œè‡ªå…³æ³¨ä¿¡æ¯ï¼ˆè¡¨ç¤ºä¸ºğ‘€ï¼‰æ·»åŠ åˆ°ç”Ÿæˆæ¨¡å‹æ¡ä»¶ä¸­ã€‚ 
  -  æˆ‘ä»¬æ¨è¢«æ–­ç¼–ç çš„æ–‡æœ¬Tä¸å»å™ªå™¨çš„**ä¸­é—´ç‰¹å¾**ï¼ˆintermediate featuresï¼‰ä¹‹é—´çš„self-attention map ğ‘€ã€‚ 

![](../../../../themes/yilia/source/img/paper/style_transfer/video_style_transfer/style_a_video/1.png)

![](img/paper/style_transfer/video_style_transfer/style_a_video/1.png)

-  é¦–å…ˆï¼Œæˆ‘ä»¬çš„ç”Ÿæˆä¸»å¹²çš„å®ç°è¢«è¡¨è¿°ä¸ºä¸€ä¸ªæ¡ä»¶æ½œåœ¨è§†é¢‘æ‰©æ•£æ¨¡å‹ã€‚ 
-  å…¶æ¬¡ï¼Œåˆ¶å¯¼æ¡ä»¶æ˜¯ç»è¿‡è®¡ç®—å’Œç¼–ç çš„ã€‚
-  ç„¶åï¼Œç»“åˆåˆ¶å¯¼æ¡ä»¶å’Œæ— åˆ†ç±»å™¨åˆ¶å¯¼è¿›è¡Œå™ªå£°é¢„æµ‹ã€‚ 
-  åœ¨é‡‡æ ·è¿‡ç¨‹ä¸­è¿›è¡Œé€æ­¥ä¼˜åŒ–ã€‚ 



## 3.1 Diffusion Model

$$L=\mathbb{E}_{\mathcal{E}(x),c_{I},c_{T},c_{M},\epsilon\sim\mathcal{N}(0,1),t}\left[\|\epsilon-\epsilon_{\theta}\left(z_{t},t,c_{I},c_{T},c_{M}\right)\right)\|_{2}^{2}]$$

- å›¾åƒæ¡ä»¶ï¼ˆä»€ä¹ˆå›¾è±¡ï¼Ÿï¼‰
- æ–‡æœ¬æç¤ºè¯æ¡ä»¶
- attention mapæ¡ä»¶

## 3.2 Condition Representation

- æˆ‘ä»¬**å­¦ä¹ ä¸€ä¸ªç½‘ç»œ**$\theta$ï¼Œå®ƒå¯ä»¥åœ¨ç»™å®šå›¾åƒæ¡ä»¶ï¼Œæ–‡æœ¬æç¤ºæ¡ä»¶ï¼Œæ³¨æ„åŠ›å›¾æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œé¢„æµ‹å™ªå£°ã€‚æˆ‘ä»¬æœ€å°åŒ–ä¸‹é¢çš„ldmç›®æ ‡ï¼š

$$L=\mathbb{E}_{\mathcal{E}(x),c_{I},c_{T},c_{M},\epsilon\sim\mathcal{N}(0,1),t}\left[\|\epsilon-\epsilon_{\theta}\left(z_{t},t,c_{I},c_{T},c_{M}\right)\right)\|_{2}^{2}]$$

 è¾“å…¥å¸§cIä½œä¸ºå†…å®¹å¼•å¯¼ï¼Œä¿è¯æœ€ç»ˆç”Ÿæˆçš„ç»“æœä¸è¾“å…¥è§†é¢‘çš„è¯­ä¹‰å†…å®¹ä¸€è‡´ã€‚ 

### 1ï¼‰é£æ ¼ç‰¹å¾

- æˆ‘ä»¬å°†ç±»åˆ«æ¡ä»¶æ›¿æ¢ä¸ºæ–‡æœ¬æç¤ºæè¿°ï¼ˆæ˜¯åœ¨é¢„è®­ç»ƒçš„æ¨¡å‹ä¸Šç›´æ¥æ›¿æ¢è¿˜æ˜¯è¯´å¼ºè°ƒä½ çš„conditionæ˜¯æ–‡æœ¬ï¼Œè€Œä¸æ˜¯ç±»åˆ«ï¼Ÿï¼‰ã€‚ç›®æ ‡é£æ ¼å¯ä»¥ä»æ–‡æœ¬æç¤ºğ‘Tä¸­è·å¾— 

### 2ï¼‰å†…å®¹ç‰¹å¾



-  ç”±äºæ‰©æ•£æ¨¡å‹çš„åŠ å™ªè¿‡ç¨‹å¯¹å†…å®¹å›¾æœ¬èº«çš„ç ´åæ€§ï¼Œä»¥åŠå»å™ªè¿‡ç¨‹çš„éšæœºæ€§ï¼Œå¾ˆéš¾åœ¨å†…å®¹ä¿ç•™ä¸Šå–å¾—è¾ƒå¥½çš„æ•ˆæœã€‚ ï¼ˆï¼Ÿï¼‰

- ä»¥å¾€çš„ä½œå“é‡‡ç”¨CLIPå›¾åƒåµŒå…¥è¡¨ç¤ºå†…å®¹æƒ…å†µï¼ˆä¸ºä»€ä¹ˆè¦è·Ÿå›¾åƒç”Ÿæˆå¯¹æ¯”ï¼Œåº”è¯¥è·Ÿé£æ ¼è¿ç§»å¯¹æ¯”å•Šï¼Ÿï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ æˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªå·ç§¯å±‚æ·»åŠ äº†é¢å¤–çš„è¾“å…¥é€šé“ï¼Œä»¥è¿æ¥$z_t$å’Œ$c_I$ ï¼ˆciæ˜¯ä»€ä¹ˆï¼Ÿï¼‰ ä»è€Œä½¿æœ€ç»ˆç”Ÿæˆçš„ç»“æœç›¸å¯¹äºè¾“å…¥è§†é¢‘åœ¨è¯­ä¹‰å†…å®¹ä¸Šå…·æœ‰æ›´å¤§çš„ä¸€è‡´æ€§ã€‚ ï¼ˆè¾“å…¥äº†å†…å®¹å›¾ï¼Œæ‰€ä»¥å†…å®¹ä¸€è‡´æ€§è‚¯å®šokå•Šï¼Ÿï¼‰
-  é¢„è®­ç»ƒçš„æ£€æŸ¥ç‚¹ç”¨äºåˆå§‹åŒ–æ‰©æ•£æ¨¡å‹çš„æ‰€æœ‰å¯ç”¨æƒå€¼ï¼Œå¹¶å°†*ä½œç”¨äºæ–°æ·»åŠ çš„è¾“å…¥é€šé“çš„*æƒå€¼è®¾ç½®ä¸ºé›¶ã€‚ 

### 3ï¼‰self-features condition

- æœ€è¿‘çš„large-scale diffusionæ¨¡å‹**é€šè¿‡å¯¹unetå¢åŠ attentionå±‚æ¥çº³å…¥æ¡ä»¶**ã€‚
- self-attention æ›´å–„äºæ•æ‰è‡ªæˆ‘ç‰¹å¾çš„å†…åœ¨å…³è” 
-  ç»™å®šæ—¶é—´æ­¥é•¿ä¸ºğ‘¡çš„ä»»æ„feature map$X_t \in \mathbb{R} ^{(HW)d}$ ,å¯¹é«˜åº¦Hå’Œå®½åº¦Wçš„n-head self attention:

$$Q_t^{(h)}=X_tW_Q^{(h)},\quad K_t^{(h)}=X_tW_K^{(h)} ï¼Œ W \in \mathbb{R}^{Cd}$$

$$A_t^{(h)}=\mathrm{softmax}\left(Q_t^{(h)}\left(K_t^{(h)}\right)^T/\sqrt{d}\right)$$

$$V_{t}^{(h)}=X_{t}W_{V}^{(h)}$$

$$A_t^{(h)}=A_t^{(h)} \cdot V_{t}^{(h)}$$

$$\psi = mean(A_t) $$

- å®šä¹‰æ³¨æ„åŠ›å›¾ï¼š$M_t=\mathbb{1}\left(A_t>\psi\right)$



## 3.3 æ¡ä»¶å¼•å¯¼

### 1ï¼‰æ— åˆ†ç±»å™¨å¼•å¯¼

-  ç”¨äºæƒè¡¡æ‰©æ•£æ¨¡å‹ç”Ÿæˆçš„æ ·æœ¬çš„è´¨é‡å’Œå¤šæ ·æ€§ã€‚ 

-  æ— åˆ†ç±»å™¨å¼•å¯¼çš„å®ç°åŒ…æ‹¬è”åˆè®­ç»ƒæ¡ä»¶å»å™ªå’Œæ— æ¡ä»¶å»å™ªçš„æ‰©æ•£æ¨¡å‹ï¼Œå¹¶ç»“åˆæ¨ç†æ—¶çš„ä¸¤ç§åˆ†æ•°ä¼°è®¡ã€‚ 

$$\tilde{\epsilon_{\theta}}\left(z_{t},c\right)=\epsilon_{\theta}\left(z_{t},\varnothing\right)+s\cdot\left(\epsilon_{\theta}\left(z_{t},c\right)-\epsilon_{\theta}\left(z_{t},\varnothing\right)\right)$$



### 2ï¼‰æ¡ä»¶å¼•å¯¼

$$\epsilon_\theta^{\prime}=\epsilon_\theta\left(z_t,\emptyset,\emptyset\right)$$

$$\begin{aligned}\tilde{\epsilon_{\theta}}\left(z_{t},c_{I},c_{T},c_{M}\right)=&(1-s_{I}-s_{\mathcal{T}}-s_{M})\cdot\epsilon_{\theta}^{\prime}\\&+s_{I}\cdot\epsilon_{\theta}\left(z_{t},c_{I},\varnothing\right)\\&+s_{\mathcal{T}}\cdot\epsilon_{\theta}\left(z_{t},\varnothing,c_{\mathcal{T}}\right)\\&+s_{M}\cdot\epsilon_{\theta}\left(z_{t},c_{M},\varnothing\right).\end{aligned}$$

- æ‰€ä»¥è¿™é‡Œç›¸å½“äºä½¿ç”¨çš„æ˜¯stable diffsuionï¼Œå¯ä»¥è¾“å…¥ä¸¤ä¸ªæ¡ä»¶ï¼šå›¾ç‰‡å’Œæ–‡å­—ï¼Œå›¾ç‰‡å¯ä»¥è¾“å…¥$c_I$æˆ–è€…$c_M$ ?



## 3.4 é‡‡æ ·ä¼˜åŒ–æŸå¤±

-  **æˆ‘ä»¬å¸Œæœ›åœ¨ä¿ç•™ç‰©ä½“åŸå§‹ å½¢çŠ¶å’Œå†…å®¹ çš„åŒæ—¶ï¼Œå…è®¸å®è´¨æ€§çš„ï¼ˆsubstantialï¼‰çº¹ç†å’Œå¤–è§‚å˜åŒ–ã€‚**

- è™½ç„¶å·²ç»æå‡ºäº†å„ç§å„æ ·çš„å†…å®¹æŸå¤±ï¼Œä½†æ˜¯å¤§å¤šæ•°éƒ½ä½¿ç”¨äº†é¢„è®­ç»ƒçš„VGGæ¨¡å‹ä¸­æå–çš„ç‰¹å¾ã€‚ï¼ˆarxivä¸Šæ²¡è¯´ä»–çš„ç¼ºç‚¹ï¼ŒæœŸåˆŠä¸ŠæŠŠè¿™å¥åˆ äº†ï¼Ÿï¼‰
- ç›¸åï¼Œ æˆ‘ä»¬åœ¨CLIPç‰¹å¾ç©ºé—´ä¸­å®šä¹‰æŸå¤±ã€‚è¿™å…è®¸æˆ‘ä»¬å¯¹Ioçš„å†…éƒ¨CLIPè¡¨ç¤ºæ–½åŠ é¢å¤–çš„çº¦æŸã€‚ ï¼ˆIoæ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿï¼‰
	$$\mathcal{L}_{s}=1-\mathcal{D}_{\cos}\left(x_{0}^{f},x_{t}^{f}\right)$$
- $x^f_0$æ˜¯è¾“å…¥å¸§ï¼Œ$x_t^f$æ˜¯é¢„æµ‹çš„å¸§

- ç„¶åå°†è¿™ä¸ªæŸå¤±å¯¹$z_t$æ±‚æ¢¯åº¦ï¼š$\Delta z_t=\nabla_{z_t}\mathcal{L}_s$ ï¼ˆä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿarxivä¸­è¯´ï¼šé€šè¿‡æœ€å°åŒ–Læ¥optimizeç½‘ç»œï¼‰
- $\Delta z_t$ å’Œå¼•å¯¼æ¡ä»¶ä¸€èµ·ä¼˜åŒ–å»å™ªç½‘ç»œï¼š$\tilde{\epsilon}_\theta=\epsilon_\theta(z_t-\lambda\Delta z_t,C_I,C_T,C_M)$



## 3.5 æ—¶é—´ä¸€è‡´æ€§

- è¾“å…¥çš„è§†é¢‘å¸§å½¼æ­¤ä¹‹é—´åœ¨short termå’Œlong termä¸Šéƒ½æ˜¯globallyä¸€è‡´çš„ã€‚ä½†æ˜¯å®ƒå¯èƒ½åŒ…å«å±€éƒ¨é—ªçƒï¼ˆè¾“å…¥çš„åŸå§‹è§†é¢‘åŒ…å«å±€éƒ¨é—ªçƒï¼Ÿï¼Ÿï¼‰ã€‚å…ˆå‰çš„å·¥ä½œè¡¨æ˜ï¼Œå±€éƒ¨é—ªçƒå¯ä»¥é€šè¿‡åŸºäºæµçš„æ­£åˆ™åŒ–å¾ˆå¥½åœ°è§£å†³ã€‚å› æ­¤æœ¬æ–‡é€‰æ‹©ä¸€ä¸ªç»è¿‡ä¿®æ”¹çš„è½»é‡çº§æ¨¡å—ã€‚

-  å‘å±€éƒ¨ç»†åŒ–ç½‘ç»œæä¾›ä¸¤ä¸ªè¿ç»­çš„å¸§ï¼ˆè¾“å…¥å¸§ï¼‰$x_0^f,x_0^{f-1}$ä»¥åŠä¹‹å‰çš„é¢„æµ‹å¸§$\hat x_0^{f-1}$ æ¥é¢„æµ‹å½“å‰å¸§$\hat x_0^{f} $ 
  - ä¸¤ä¸ªè¿ç»­å¸§é¦–å…ˆç´§æ¥ç€ä¸€äº›å·ç§¯å±‚ï¼Œç„¶åä¸$\hat x_0^{f-1}$èåˆ
  - ç½‘ç»œæŸå¤±ï¼š$\mathcal{L}_{temporal}=\left\|M_{f,f-1}\odot\left(x_{0}^{f}-\hat{x_{0}}^{f-1}\right)\right\|_{1}$ ï¼ˆæ„Ÿè§‰è¿™é‡Œ$x_0^f$åº”è¯¥å†™é”™äº†ï¼Œåº”è¯¥æ˜¯$\hat x_0 ^f$ )
    - $\hat x _0 ^{f-1}$ æ˜¯é€šè¿‡å°†$x_0^{f-1}$ä½¿ç”¨ä»tåˆ°t-1å¸§çš„å…‰æµå¾—åˆ°çš„ï¼ˆè¿™é‡Œarxivä¸Šæ²¡å†™å‡ºlossè¡¨è¾¾å¼ï¼Œä¹Ÿæ²¡è§£é‡Šï¼ŒæœŸåˆŠè®ºæ–‡ä¸Šæœ‰è§£é‡Šï¼Œä½†æ˜¯çœ‹ç€å¥½åƒé”™äº†ï¼Œåº”è¯¥æ˜¯ä»få¸§åˆ°f-1å¸§ï¼Ÿ



# 4. å®éªŒ

- 3090
- 512*256çš„å¸§éœ€è¦1s
- ä½¿ç”¨Unetæ¶æ„ä¸ºWide-resnet
- æ—¶é—´æ­¥é•¿ä¸º30
- Style  a video obviates the need for further training

## 1ï¼‰qualitative evaluation

![](../../../../themes/yilia/source/img/paper/style_transfer/video_style_transfer/style_a_video/2.png)

![](img/paper/style_transfer/video_style_transfer/style_a_video/2.png)

- ç¬¬ä¸€è¡Œï¼Œä¸åŸºäºdiffusionçš„æ–¹æ³•ç›¸æ¯”ï¼Œæœ¬æ–‡å†…å®¹ä¿æŒæ›´å¥½ã€‚ä»–ä»¬æ˜æ˜¾åç¦»äº†ç›®æ ‡é£æ ¼ï¼ˆç¬¬äºŒè¡Œæœ€å·¦ï¼‰

-  å®ƒåœ¨å¤åˆ¶è‰ºæœ¯ä½œå“çš„çº¹ç†ã€å…‰æ³½åº¦å’Œå…‰çº¿ç»†å¾®å·®åˆ«æ–¹é¢ä¼˜äºCSBNet  å’ŒMCCNet2 

- ä¼ ç»Ÿé£æ ¼è¿ç§»æ–¹æ³•ï¼ˆç¬¬äºŒåˆ—åå››ä¸ªï¼‰ è™½ç„¶åœ¨é¢œè‰²å’Œé£æ ¼ä¸Šä¸å‚è€ƒå›¾åƒå¾ˆå¥½åœ°ä¸€è‡´ï¼Œä½†å®ƒä»¬ç¼ºä¹çœŸå®æ„Ÿå’Œç”ŸåŠ¨æ€§ã€‚ 

-  ä¸ä¸Šè¿°æ–¹æ³•ç›¸æ¯”ï¼ŒStyle-A-Videoåœ¨è‰ºæœ¯è¡¨è¾¾å’Œç»“æ„ä¿å­˜æ–¹é¢è¡¨ç°å‡ºè‰²ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¿æŒè§†é¢‘å¸§é—´æ—¶é—´ä¸€è‡´æ€§çš„åŒæ—¶å‡å°‘å¸§é—´é—ªçƒç­‰ä¸åˆ©çš„è‰ºæœ¯å½±å“ã€‚ 

## 2ï¼‰quantitative evaluation

- é€‰æ‹©25ä¸ªè§†é¢‘è¿›è¡Œå¯¹æ¯”ï¼Œ
  - ä¸ºäº†è¯„ä¼°æ—¶é—´ä¸€è‡´æ€§ï¼šä½¿ç”¨å¸¸è§çš„æ—¶é—´æŸå¤±ï¼š$\mathcal{L}_{temporal}=||O\circ(W_{X_n\to X_{n-i}}(Y_n)-Y_{n-i}))||$ ï¼ˆè¿™é‡Œçš„æ—¶é—´ä¸€è‡´æ€§æŸå¤±ä¸è®­ç»ƒæŸå¤±å†²çªå—ï¼Ÿï¼‰
  - ä¸ºäº†è¯„ä¼°é£æ ¼åŒ–å¸§çš„å‡†ç¡®æ€§ï¼šè®¡ç®—è¾“å…¥å¸§å’Œè¾“å‡ºå¸§çš„CLIPæ–‡æœ¬åµŒå…¥ä¹‹é—´çš„å¹³å‡ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œä»¥æ­¤è¯„ä¼°å†…å®¹ä¿å­˜
  - ä¸ºäº†è¯„ä¼°é£æ ¼åŒ–æ•ˆæœï¼šè®¡ç®—è¾“å‡ºå¸§å’Œæç¤ºè¯çš„CLIPæ–‡æœ¬åµŒå…¥ä¹‹é—´çš„å¹³å‡ä½™å¼¦ç›¸ä¼¼åº¦

![](../../../../themes/yilia/source/img/paper/style_transfer/video_style_transfer/style_a_video/3.png)

![](img/paper/style_transfer/video_style_transfer/style_a_video/3.png)



## 3ï¼‰Ablation

![](../../../../themes/yilia/source/img/paper/style_transfer/video_style_transfer/style_a_video/4.png)

![](img/paper/style_transfer/video_style_transfer/style_a_video/4.png)

- å€¼è¶Šå¤§è¡¨ç¤ºè¿™ä¸ªæ¡ä»¶æ§åˆ¶è¶Šå¼ºï¼Œå›¾ä¸­ç›¸åº”çš„æŒ‡æ ‡ä¹Ÿè¶Šå¤§ï¼Œå¦ä¸€ä¸ªæŒ‡æ ‡å°±å˜å·®ã€‚ï¼ˆæ–‡ç« å¹¶æ²¡æœ‰è¯´éšç€$s_I$çš„å˜åŒ–ï¼Œå…¶ä»–çš„ï¼›å˜é‡æ˜¯å›ºå®šçš„ï¼Œæœ‰æ²¡æœ‰æ§åˆ¶å˜é‡ï¼Ÿè¿™é‡Œçš„ablationåšçš„å¯¹å—ï¼Ÿæ„Ÿè§‰åº”è¯¥æ˜¯å¯¹æ¯”ç”¨ä¸€ä¸ªæ¡ä»¶ï¼Œä¸¤ä¸ªæ¡ä»¶ï¼Œä¸‰ä¸ªæ¡ä»¶ä¹‹é—´çš„æ•ˆæœï¼‰

![](../../../../themes/yilia/source/img/paper/style_transfer/video_style_transfer/style_a_video/5.png)

![](img/paper/style_transfer/video_style_transfer/style_a_video/5.png)

-  é€šè¿‡çƒ­å›¾åˆ†æè¿›ä¸€æ­¥è¯„ä»·äº†è‡ªæ³¨æ„æ©æ¨¡æ¡ä»¶å’Œæ—¶é—´ä¸€è‡´æ€§æ¨¡å—å¯¹å¸§é—´ä¸€è‡´æ€§çš„å½±å“ã€‚ å»é™¤è‡ªæ³¨æ„å›¾æ¡ä»¶ä¼šå¯¼è‡´ç²¾ç»†ç»†èŠ‚çš„ä¸¢å¤±ï¼Œè€Œæ²¡æœ‰æ—¶é—´ä¸€è‡´æ€§è®¾è®¡ä¼šå¯¼è‡´è§†é¢‘å¸§é—´å‡ºç°æ˜æ˜¾çš„æŠ–åŠ¨å’Œé—ªçƒã€‚ 

![](../../../../themes/yilia/source/img/paper/style_transfer/video_style_transfer/style_a_video/6.png)

![](img/paper/style_transfer/video_style_transfer/style_a_video/6.png)

- ä½¿ç”¨DVP warping errorè®¡ç®—æ—¶é—´ä¸€è‡´æ€§ï¼šï¼ˆåˆ†åˆ«è®¡ç®—å½“å‰å¸§å’Œç¬¬ä¸€å¸§/å‰ä¸€å¸§çš„temporal lossç„¶ååŠ èµ·æ¥ï¼‰

  $$\begin{aligned}
  E_{pair}(O_{t},O_{s})& =\frac{1}{\sum_{i=1}^{N}M_{t,s}(x_{i})}\sum_{i=1}^{N}M_{t,s}(x_{i})\|O_{t}(x_{i})-W(O_{s})(x_{i})\|_{1}, \\
  E_{warp}(\{O_t\}_{t=1}^T)& =\frac1{T-1}\sum_{t=2}^T\{E_{pair}(O_t,O_1)+E_{pair}(O_t,O_{t-1})\}, 
  \end{aligned}$$