---
title: 1-5 å‰ç¼€å’Œä¸å·®åˆ†

date: 2024-6-2

tags: [ç®—æ³•ï¼Œå·®åˆ†]

categories: [ç®—æ³•]

comment: false

toc: true
---

#

<!--more-->

# 5 å‰ç¼€å’Œä¸å·®åˆ†

## 5.1 ä¸€ç»´åŒºé—´å’Œ

- è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°åºåˆ—ã€‚æ¥ä¸‹æ¥å†è¾“å…¥ m ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®è¾“å…¥ä¸€å¯¹ l,rã€‚å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œè¾“å‡ºåŸåºåˆ—ä¸­ä»ç¬¬ lä¸ªæ•°åˆ°ç¬¬ rä¸ªæ•°çš„å’Œã€‚

- è¾“å…¥æ ¼å¼

  - ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° nå’Œ mã€‚

  - ç¬¬äºŒè¡ŒåŒ…å« nä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´æ•°æ•°åˆ—ã€‚
  - æ¥ä¸‹æ¥ mè¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° lå’Œ rï¼Œè¡¨ç¤ºä¸€ä¸ªè¯¢é—®çš„åŒºé—´èŒƒå›´ã€‚

-  è¾“å‡ºæ ¼å¼ï¼šå…± mè¡Œï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªè¯¢é—®çš„ç»“æœã€‚

- æ•°æ®èŒƒå›´
  - 1â‰¤lâ‰¤râ‰¤n
  - 1â‰¤n,mâ‰¤100000
  - âˆ’1000â‰¤æ•°åˆ—ä¸­å…ƒç´ çš„å€¼â‰¤1000

- è¾“å…¥æ ·ä¾‹ï¼š

    ```
    5 3
    2 1 3 6 4
    1 2
    1 3
    2 4
    ```

- è¾“å‡ºæ ·ä¾‹ï¼š

    ```
    3
    6
    10
    ```

### 5.1.1 æ¨¡æ¿

```c++
#include<iostream>
using namespace std;

const int N=100000;
int a[N]={0},s[N]={0};

int main(){
    int n,m;
    //ios::sync_with_stdio(false); //å¯ä»¥åŠ å¿«cinï¼Œä½†è¿˜æ˜¯æ²¡æœ‰scanfå¿«
    scanf("%d%d",&n,&m); //è¾“å…¥è§„æ¨¡æ¯”è¾ƒå¤§æ—¶ä½¿ç”¨scanfæ›´å¿«
    for(int i=1; i<=n;i++) scanf("%d",&a[i]);
    for(int i=1;i<=n;i++) s[i] = s[i-1] + a[i]; //å‰ç¼€å’Œåˆå§‹åŒ–
    
    while(m--){
        int l,r;
        scanf("%d%d",&l,&r);
        printf("%d\n",s[r]-s[l-1]); //è®¡ç®—åŒºé—´å’Œ
    }
    
    return 0;
}
```



## 5.2 äºŒç»´åŒºé—´å’Œ

- è¾“å…¥ä¸€ä¸ª nè¡Œ måˆ—çš„æ•´æ•°çŸ©é˜µï¼Œå†è¾“å…¥ qä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®åŒ…å«å››ä¸ªæ•´æ•° x1,y1,x2,y2ï¼Œè¡¨ç¤ºä¸€ä¸ªå­çŸ©é˜µçš„å·¦ä¸Šè§’åæ ‡å’Œå³ä¸‹è§’åæ ‡ã€‚å¯¹äºæ¯ä¸ªè¯¢é—®è¾“å‡ºå­çŸ©é˜µä¸­æ‰€æœ‰æ•°çš„å’Œã€‚

- è¾“å…¥æ ¼å¼

  - ç¬¬ä¸€è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° nï¼Œmï¼Œqã€‚

  - æ¥ä¸‹æ¥ nè¡Œï¼Œæ¯è¡ŒåŒ…å« mä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´æ•°çŸ©é˜µã€‚

  - æ¥ä¸‹æ¥ qè¡Œï¼Œæ¯è¡ŒåŒ…å«å››ä¸ªæ•´æ•° x1,y1,x2,y2ï¼Œè¡¨ç¤ºä¸€ç»„è¯¢é—®ã€‚

- è¾“å‡ºæ ¼å¼ï¼šå…± qè¡Œï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªè¯¢é—®çš„ç»“æœã€‚

- æ•°æ®èŒƒå›´
  - 1â‰¤n,mâ‰¤1000,
  - 1â‰¤qâ‰¤200000,
  - 1â‰¤x1â‰¤x2â‰¤n,
  - 1â‰¤y1â‰¤y2â‰¤m,
  - âˆ’1000â‰¤çŸ©é˜µå†…å…ƒç´ çš„å€¼â‰¤1000

- è¾“å…¥æ ·ä¾‹ï¼š

    ```
    3 4 3
    1 7 2 4
    3 6 2 8
    2 1 2 3
    1 1 2 2
    2 1 3 4
    1 3 3 4
    ```

- è¾“å‡ºæ ·ä¾‹ï¼š

    ```
    17
    27
    21
    ```



### 5.2.1 æ€æƒ³

- ç”»çŸ©å½¢åˆ†å—ï¼š
  - $S_ { x _ 1 y _ 1 - x_ 2 y_ 2 } = S_ { x_ 2 y_ 2 } - S_ { x_ 2 (y_ 1-1) } - S_ { (x_ 1-1) y_ 2 }+ S_ { (x_ 1-1)(y_ 1 -1) }$
  - $S_ {ij} = S_ { (i-1)j } + S_ { i(j-1) }-S_ { (i-1)(j-1) } + a_ { ij }$

### 5.2.2 æ¨¡æ¿

```c++
#include<iostream>
using namespace std;

const int N=1001;
int s[N][N];

int main(){
    int m,n,q,x,y;
    scanf("%d%d%d",&n,&m,&q);
    for(int i=1;i<=n;i++)
        for(int j=1;j<=m;j++)
            {
                scanf("%d",&s[i][j]);
                //+=çœå»äº†a[i][j]
                s[i][j] += s[i-1][j]+s[i][j-1]-s[i-1][j-1];
            }
            
    while(q--){
        scanf("%d%d%d%d",&m,&n,&x,&y);
        cout<<s[x][y]-s[x][n-1]-s[m-1][y]+s[m-1][n-1]<<endl;
    }
    return 0;
}
```



## 5.3 å·®åˆ†

- å·²çŸ¥ï¼š
  - $a_ 1,a_ 2 \ldots , a_ n$
- æ±‚ï¼š
  - $b_ 1, b_ 2, \ldots,b_ n$
  - è¦æ±‚ï¼š$b_ i = a_ i - a_ { i-1 }$
- $a$æ˜¯$b$çš„å‰ç¼€å’Œ
- å·®åˆ†çš„ä½œç”¨ï¼šå‡è®¾ä½ éœ€è¦å°†ä»$a_m$åˆ° $a_ n$ä¹‹é—´çš„æ•°å…¨éƒ½åŠ ä¸Šä¸€ä¸ªå¸¸ç†ŸCï¼Œåœ¨$a$ä¸Šæ“ä½œéœ€è¦$O(n)$ï¼›è€Œåœ¨$b$ä¸Šæ“ä½œåªéœ€è¦å°†$b_ m+C$å’Œ$b_ {n-1}-C$å°±å¯ä»¥äº†ï¼Œè¿™æ ·åªéœ€è¦$O(1)$

### 5.3.1 é¢˜ç›®

- è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º nçš„æ•´æ•°åºåˆ—ã€‚æ¥ä¸‹æ¥è¾“å…¥ mä¸ªæ“ä½œï¼Œæ¯ä¸ªæ“ä½œåŒ…å«ä¸‰ä¸ªæ•´æ•° l,r,cï¼Œè¡¨ç¤ºå°†åºåˆ—ä¸­ [l,r][ğ‘™,ğ‘Ÿ] ä¹‹é—´çš„æ¯ä¸ªæ•°åŠ ä¸Š cã€‚è¯·ä½ è¾“å‡ºè¿›è¡Œå®Œæ‰€æœ‰æ“ä½œåçš„åºåˆ—ã€‚

- è¾“å…¥æ ¼å¼

  - ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° n å’Œ mã€‚

  - ç¬¬äºŒè¡ŒåŒ…å« nä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´æ•°åºåˆ—ã€‚

  - æ¥ä¸‹æ¥ mè¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° lï¼Œrï¼Œcï¼Œè¡¨ç¤ºä¸€ä¸ªæ“ä½œã€‚

- è¾“å‡ºæ ¼å¼
  
- å…±ä¸€è¡Œï¼ŒåŒ…å« nä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€ç»ˆåºåˆ—ã€‚
  
- æ•°æ®èŒƒå›´
  - 1â‰¤n,mâ‰¤100000,
  - 1â‰¤lâ‰¤râ‰¤n,
  - âˆ’1000â‰¤câ‰¤1000,
  - âˆ’1000â‰¤æ•´æ•°åºåˆ—ä¸­å…ƒç´ çš„å€¼â‰¤1000

-  è¾“å…¥æ ·ä¾‹ï¼š

    ```
    6 3
    1 2 2 1 2 1
    1 3 1
    3 5 1
    1 6 1
    ```

-  è¾“å‡ºæ ·ä¾‹ï¼š

    ```
    3 4 5 3 4 2
    ```

### 5.3.2 æ€æƒ³

- æ ¹æ®aæ„å»ºbï¼š
    ```
    //å‡è®¾bæ˜¯açš„å·®åˆ†
    b[i] += a[i] //b[i]åŠ ä¸€æ¬¡ç›¸å½“äºæŠŠåé¢æ‰€æœ‰aéƒ½åŠ äº†åç§»
    b[i+1] -= a[i] //å°†åé¢çš„åç§»å…¨éƒ¨å‡æ‰ï¼Œaä¸å˜ï¼Œå‡è®¾ä¾ç„¶æˆç«‹
    ```

### 5.3.3 æ¨¡æ¿

```c++
#include<iostream>
using namespace std;

const int N= 100010;
int a[N],b[N];

void insert(int l, int r, int c){
    b[l]+=c;
    b[r+1]-=c;
}

int main(){
    int n,m;
    scanf("%d%d",&n,&m);
    //a
    for(int i=1;i<=n;i++) scanf("%d",&a[i]);
    
    //b
    for(int i=1;i<=n;i++) insert(i,i,a[i]);
    
    while(m--){
        int l,r,c;
        scanf("%d%d%d",&l,&r,&c);
        insert(l,r,c);
    }
    
    //b->a
    for(int i=1;i<=n;i++) b[i]+=b[i-1];
    
    for(int i=1;i<=n;i++) printf("%d ",b[i]);
    
    return 0;
}
```



## 5.4 å·®åˆ†çŸ©é˜µ

- è¾“å…¥ä¸€ä¸ª nè¡Œ måˆ—çš„æ•´æ•°çŸ©é˜µï¼Œå†è¾“å…¥ qä¸ªæ“ä½œï¼Œæ¯ä¸ªæ“ä½œåŒ…å«äº”ä¸ªæ•´æ•° x1,y1,x2,y2,cï¼Œå…¶ä¸­ (x1,y1)å’Œ (x2,y2)è¡¨ç¤ºä¸€ä¸ªå­çŸ©é˜µçš„å·¦ä¸Šè§’åæ ‡å’Œå³ä¸‹è§’åæ ‡ã€‚æ¯ä¸ªæ“ä½œéƒ½è¦å°†é€‰ä¸­çš„å­çŸ©é˜µä¸­çš„æ¯ä¸ªå…ƒç´ çš„å€¼åŠ ä¸Š cã€‚è¯·ä½ å°†è¿›è¡Œå®Œæ‰€æœ‰æ“ä½œåçš„çŸ©é˜µè¾“å‡ºã€‚

- è¾“å…¥æ ¼å¼

  - ç¬¬ä¸€è¡ŒåŒ…å«æ•´æ•° n,m,qã€‚

  - æ¥ä¸‹æ¥ nè¡Œï¼Œæ¯è¡ŒåŒ…å« mä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ•´æ•°çŸ©é˜µã€‚

  - æ¥ä¸‹æ¥ qè¡Œï¼Œæ¯è¡ŒåŒ…å« 5ä¸ªæ•´æ•° x1,y1,x2,y2,cï¼Œè¡¨ç¤ºä¸€ä¸ªæ“ä½œã€‚

- è¾“å‡ºæ ¼å¼
  
- å…± nè¡Œï¼Œæ¯è¡Œ mä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ‰€æœ‰æ“ä½œè¿›è¡Œå®Œæ¯•åçš„æœ€ç»ˆçŸ©é˜µã€‚
  
- æ•°æ®èŒƒå›´
  - 1â‰¤n,mâ‰¤1000,
  - 1â‰¤qâ‰¤100000,
    1â‰¤x1â‰¤x2â‰¤n,
  - 1â‰¤y1â‰¤y2â‰¤m,
  - âˆ’1000â‰¤câ‰¤1000,
  - âˆ’1000â‰¤çŸ©é˜µå†…å…ƒç´ çš„å€¼â‰¤1000

- è¾“å…¥æ ·ä¾‹ï¼š

    ```
    3 4 3
    1 2 2 1
    3 2 2 1
    1 1 1 1
    1 1 2 2 1
    1 3 2 3 2
    3 1 3 4 1
    ```

- è¾“å‡ºæ ·ä¾‹ï¼š

    ```
    2 3 4 1
    4 3 4 1
    2 2 2 2
    ```

### 5.4.1 æ€æƒ³

- ä»¤b=0ï¼Œç”»å‡ºçŸ©é˜µåŒºåŸŸå¾—åˆ°è®¡ç®—ä¸€ä¸ª$b_ {ij}$çš„æ–¹æ³•ï¼š

  $b_ {x_ 1 y_ 1} += c$

  $b_ { (x_ 2+1) y_ 1} -= c$

  $b_ { x_ 1 (y_ 2 +1)} -= c$

  $b_ { (x_ 2+1) (y_ 2 +1)} += c$

### 5.4.2 æ¨¡æ¿

```c++
#include<iostream>
using namespace std;

const int N = 1010;
int a[N][N], b[N][N];

void insert(int x1, int y1, int x2, int y2, int c){
    b[x1][y1] += c;
    b[x2+1][y1] -= c;
    b[x1][y2+1] -= c;
    b[x2+1][y2+1] += c;
}

int main(){
    int n,m,q;
    cin>>n>>m>>q;
    //a
    for(int i=1;i<=n;i++)
        for(int j=1;j<=m;j++)
            scanf("%d",&a[i][j]);
            
    //b
    for(int i=1;i<=n;i++)
        for(int j=1;j<=m;j++)
            insert(i,j,i,j,a[i][j]);
            
    while(q--){
        int x1,y1,x2,y2,c;
        cin>>x1>>y1>>x2>>y2>>c;
        //å¯¹bæ“ä½œ
        insert(x1,y1,x2,y2,c);
    }
    
    //b->a
    for(int i=1;i<=n;i++){
        for(int j=1;j<=m;j++)
            cout<<(b[i][j] += b[i-1][j]+b[i][j-1]-b[i-1][j-1])<<' '; 
        cout<<'\n';
    }

            
    return 0;
}
```

